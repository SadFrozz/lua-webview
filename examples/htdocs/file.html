<!DOCTYPE html>
<html><head lang="en">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="UTF-8">
  <title>File</title>
  <style type="text/css">
html, body {
  margin: 0;
  padding: 0;
}
html {
  height: 100%;
}
#app {
	background-color: white;
}
.section {
  margin: 2rem;
}
.file-chooser-dialog {
  width: 100%;
	height: 100%;
  position: absolute;
  top: 0;
  left: 0;
	background-color: inherit;
}
  </style>
  <link rel="stylesheet" href="FileChooser.css">
  <script src="assets/vue.min.js" type="text/javascript"></script>
  <script src="../../webview-init.js" type="text/javascript"></script>
  <script src="FileChooser.js" type="text/javascript"></script>
  <script src="FileChooser.lua" type="text/lua"></script>
</head><body>
  <div id="app">
    <p>This example shows how to choose a file to operate using Lua.</p>
    <div class="section">
      <h5>Using a dedicated panel</h5>
      <button v-on:click="openFileChooser()">Open</button>
      <button v-on:click="openFileChooser(true)">Multiple</button>
      <button v-on:click="openFileChooser(false, true)">Save</button>
      <button v-on:click="openFileChooser(false, false, true)">Directory</button>
      <p><span>{{ filename }}</span></p>
    </div>
    <div class="section">
      <h5>Using a single input field</h5>
      <file-chooser-input ref="fileChooserInput"></file-chooser-input>
    </div>
  </div>
  <script type="text/javascript">
    var vm = new Vue({
      el: '#app',
      data: {
        chooseFile: false,
        filename: '',
        fileChooser: null
      },
      methods: {
        openFileChooser: function(multiple, save, directory) {
          if (this.fileChooser) {
            return;
          }
          var FileChooser = Vue.component('file-chooser-dialog');
          var fileChooser = new FileChooser();
          this.fileChooser = fileChooser;
          fileChooser.$mount();
          fileChooser.multiple = multiple === true;
          fileChooser.directory = directory === true;
          fileChooser.save = save === true;
          fileChooser.label = save === true ? 'Save' : 'Open';
          this.$el.appendChild(fileChooser.$el);
          fileChooser.$on('selected', function(files) {
            vm.filename = files ? files.join(' ') : '';
            vm.closeFileChooser();
          });
          fileChooser.refresh();
        },
        closeFileChooser: function() {
          if (this.fileChooser) {
            this.$el.removeChild(this.fileChooser.$el);
            this.fileChooser.$destroy();
            this.fileChooser = null;
          }
        }
      }
    });
    function onWebviewInitalized(webview) {
      vm.$refs.fileChooserInput.list('.');
    };
  </script>
</body></html>